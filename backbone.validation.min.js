// Backbone.Validation v0.2.0
//
// Copyright (C)2011 Thomas Pedersen
// Distributed under MIT License
//
// Documentation and full license availabe at:
// http://github.com/thedersen/backbone.validation
Backbone.Validation=(function(F,C,E){var B=function(H){var I={};for(var G in H.validation){if(H.validation.hasOwnProperty(G)){I[G]=E;}}return I;};var D=function(J,G){var I=J.validation[G],H=[];if(C.isFunction(I)){return I;}else{if(C.isString(I)){return J[I];}else{for(var K in I){if(K!=="msg"&&I.hasOwnProperty(K)){H.push({fn:F.Validation.validators[K],val:I[K],msg:I.msg});}}return H;}}};var A=function(K,H,N){var I=D(K,H),J="",M,G;if(C.isFunction(I)){return I.call(K,N);}else{for(var L=0;L<I.length;L++){M=I[L];G=M.fn(N,H,M.val);if(G===false){return"";}else{if(G){J+=M.msg||G;}}}return J;}};return{version:"0.2.0",bind:function(H,K){K=K||{};var J=H.model,I=K.valid||F.Validation.callbacks.valid,G=K.invalid||F.Validation.callbacks.invalid;J.validate=function(M){if(!M){return J.validate.call(J,C.extend(B(J),J.toJSON()));}var P=true,L;for(var O in M){if(O==="isValid"){return false;}L=A(J,O,M[O]);if(L){G(H,O,L);}else{I(H,O);}}if(L){J.set({isValid:false});}else{for(var N in J.validation){if(C.isUndefined(M[N])&&A(J,N,J.get(N))){P=false;break;}}J.set({isValid:P});}return L;};},unbind:function(G){G.model.validate=E;}};}(Backbone,_));Backbone.Validation.callbacks={valid:function(B,A){B.$("#"+A).removeClass("invalid");B.$("#"+A).removeAttr("data-error");},invalid:function(B,A,C){B.$("#"+A).addClass("invalid");B.$("#"+A).attr("data-error",C);}};Backbone.Validation.patterns={number:/^-?\d+$/,email:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i};Backbone.Validation.validators=(function(E,C){var A=String.prototype.trim?function(F){return F==null?"":String.prototype.trim.call(F);}:function(H){var G=/^\s+/,F=/\s+$/;return H==null?"":H.toString().replace(G,"").replace(F,"");};var B=function(F){return C.isNumber(F)||(C.isString(F)&&F.match(E.number));};var D=function(F){return !(C.isNull(F)||C.isUndefined(F)||(C.isString(F)&&A(F)===""));};return{required:function(G,F,H){if(!H&&(!D(G))){return false;}if(H&&!D(G)){return F+" is required";}},acceptance:function(G,F){if(!C.isBoolean(G)||G===false){return F+" must be accepted";}},min:function(H,F,G){if(!B(H)||H<G){return F+" must be larger than or equal to "+G;}},max:function(G,F,H){if(!B(G)||G>H){return F+" must be less than or equal to "+H;}},length:function(H,F,G){H=A(H);if(!D(H)||H.length!==G){return F+" must have exact "+G+" characters";}},minLength:function(H,F,G){if(!D(H)||A(H).length<G){return F+" must be longer than or equal to "+G+" characters";}},maxLength:function(H,F,G){if(!D(H)||A(H).length>G){return F+" must be shorter than or equal to"+G+" characters";}},pattern:function(H,F,G){G=E[G]||G;if(!D(H)||!H.toString().match(G)){return F+" is not a valid "+G;}}};}(Backbone.Validation.patterns,_));